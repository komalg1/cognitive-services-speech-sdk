repos:
  - repo: local
    hooks:
      - id: bicep
        name: bicep
        description: "Lint and build Bicep files"
        entry: bash -c 'for file in $(git diff --cached --name-only --diff-filter=ACM | grep "\.bicep$"); do echo "Building $file..."; bicep build "$file" -o "${file%.bicep}.json" || exit 1; git add "${file%.bicep}.json"; done'
        language: system
        files: ^infra/.*$
